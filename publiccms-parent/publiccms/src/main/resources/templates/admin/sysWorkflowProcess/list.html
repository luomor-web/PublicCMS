<@sys.workflowProcessList itemType=itemType itemId=itemId createUserId=createUserId title=title roleIds=admin.roles deptId=admin.deptId userId=admin.id closed=closed orderType=orderType pageIndex=pageNum pageSize=numPerPage>
<div class="pageHeader card">
    <form class="pagerForm" autocomplete="off" onsubmit="return navTabSearch(this);" method="post">
        <#include "../include_page/parameters.html"/>
        <div class="searchBar">
            <ul class="searchContent">
                <li>
                    <label><@t.page 'item_type'/>:</label>
                    <select class="combox" name="itemType">
                        <option value><@t.page 'item_type'/></option>
                        <#list getProcessTypeList() as o>
                        <option value="${o}"><@t.page o/></option>
                        </#list>
                    </select>
                </li>
                <li>
                    <label><@t.page 'item'/>:</label>
                    <input type="text" name="itemId" value="${itemId!}"/>
                </li>
                <li>
                    <label><@t.page 'title'/>:</label>
                    <input type="text" name="title" value="${title!}"/>
                </li>
                <li>
                    <label><@t.page 'content.promulgator'/>:</label>
                    <#if createUserId?has_content><@sys.user id=createUserId><#assign u=object/></@sys.user></#if>
                    <input name="createUserId" value="${(u.id)!}" type="hidden"/>
                    <input name="nickname" readonly="readonly" size="10" value="${(u.nickname)!}" type="text"/>
                    <a class="btnLook" href="sysUser/lookup.html?field=createUserId" width="1200" height="580" lookupGroup=""><@t.page 'user.select'/></a>
                </li>
            </ul>
            <div class="subBar">
                <ul>
                    <li>
                        <button type="submit" class="buttonActive"><@t.page 'button.search'/></button>
                    </li>
                </ul>
            </div>
        </div>
    </form>
</div>
<@_sysAuthorized roleIds=admin.roles urls='sysWorkflowProcess/processParameters'><#assign authorizedMap=map/></@_sysAuthorized>
<div class="pageContent card">
    <table class="table" width="100%" layoutH "${orderField!}" orderType="${orderType!}" data-todo="${(page.totalCount gt 0)?then(page.totalCount,'')}" data-todo-type="process_list">
        <thead>
            <tr>
                <th width="20"><input type="checkbox" group="ids" class="checkboxCtrl"></th>
                <th><@t.page 'title'/></th>
                <th><@t.page 'workflow'/>:<@t.page 'step'/></th>
                <th><@t.page 'content.promulgator'/></th>
                <th orderField="createDate"><@t.page 'create_date'/></th>
                <th><@t.page 'update_date'/></th>
                <th><@t.page 'operate'/></th>
            </tr>
        </thead>
        <tbody>
            <#list page.list as a>
                <@t.merge 'workflowIds' a.workflowId!/>
                <@t.merge 'stepIds' a.stepId!/>
                <@t.merge 'userIds' a.createUserId!/>
            </#list>
            
            <@sys.workflow ids=t.workflowIds!><#assign workflowMap=map!/></@sys.workflow>
            <@sys.workflowStep ids=t.stepIds!><#assign stepMap=map!/></@sys.workflowStep>
            <@sys.user ids=t.userIds!><#assign userMap=map!/></@sys.user>
            
            <#list page.list as a>
            <tr target="sid" rel="${a.id}">
                <td class="center"><input name="ids" value="${a.id}" type="checkbox"></td>
                <td><a href="<#if a.itemType="content">cmsContent/view.html?id=${a.itemId}</#if>" class="exclude-translate" target="dialog" rel="viewProcess${a.id}" width="1200" height="500">${a.title!}</a></td>
                <td><a href="sysWorkflowProcess/view.html?id=${a.id}" class="exclude-translate" target="dialog" rel="viewProcess${a.id}" width="1200" height="500">${(workflowMap[a.workflowId?string].name)!t.pageMessage('page.disabled')} : ${(stepMap[a.stepId?string].name)!t.pageMessage('page.disabled')}</a></td>
                <td class="exclude-translate">${(userMap[a.createUserId?string].nickname)!}</td>
                <td>${a.createDate!}</td>
                <td>${a.updateDate!}</td>
                <td>
                <#if authorizedMap['sysWorkflowProcess/processParameters']>
                    <a href="sysWorkflowProcess/processParameters.html?id=${a.id}" class="edit btnText green" target="dialog" width="1200" height="500" mask="true"><@t.page 'button.handle'/></a>
                </#if>
                </td>
            </tr>
            </#list>
        </tbody>
    </table>
    <#include "../include_page/page.html"/>
</div>
</@sys.workflowProcessList>